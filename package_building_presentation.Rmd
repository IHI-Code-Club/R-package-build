---
title: "Package Building"
subtitle: "with RStudio tools"
author: "Chris Mainey"
date: "2020/08/30 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    seal: false

---
class: title-slide right

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.width=10, fig.height=6, fig.align = "center", dpi=300,
                      dev.args = list(png = list(type = "cairo")), fig.retina=3) 
library(Cairo)
```


<br><br><br>
# Why and how to build an R package

#### Chris Mainey - Univeristy Hosptials Birmingham NHS FT

<br><br>

chris.mainey@uhb.nhs.uk `r icon::fa("envelope")` 

[mainard.co.uk](https://www.mainard.co.uk) `r icon::fa("globe")` 

[github.com/chrismainey](https://github.com/chrismainey) `r icon::fa("github")` 

[twitter.com/chrismainey](https://twitter.com/chrismainey) `r icon::fa("twitter")` 


---

# Overview

Webinar will cover:

+ What is an R package and why might you want to build one
--

+ Functions
--

+ Package basic structures and concepts
--

+ Roxygen2 documentation and vignettes
--

+ Dependencies
--

+ Build and check
--

+ Extras:
 + Source control (Git and GitHub)
 + Unit Tests and code coverage
 + Releasing to CRAN

--

__We'll look at this practically by building an R package__


References:
+ [Hadley Wickham, Jenny Bryan's: Building R packages](https://r-pkgs.org/)
+ [`R` official Documentation](https://cran.r-project.org/doc/manuals/R-exts.html#Creating-R-packages)

---
 
# R packages

+ We use packages all the time (base, stats, utils), and `R` is built on them.
+ `R` package repostiory CRAN has xxxxxxxxx packages at time of writing
+ Other places like Bioconductor, source pacakges on GitHub etc.

You've probably installed `tidyverse`, `dplyr`, `ggplot2` or other popular packages

--

+ __What are they?__
 + Collections of functions related to certain workflows and task
 + Up to the author what goes in
 + Can be depend on other packages or be written
--

+ __Why use them?__
 + Don't reinvent the wheel!
 + Do you know how to do [Insert thing] better than an expert?
--

+ __Why build a package?__
 + You might be the expert!
 + You can share your code with colleagues, or others, adn build collaboratively.

---

# But I can't build one...

__...yes you can.__  You don't need perfect code to share it (as you'll see from mine)

+ You can get much of the background by following today and looking online.
+ We need to convert our code to a `function`
+ Need to consider as generic input and output

.pull-left[

### You have code like this:

```{r orig, eval=FALSE}

mydataframe$new_col <-
  mydataframe$new_col + 2.5 / 50 

```
]

.pull-right[

### Turn it into a function:

```{r asfunc, eval=FALSE}
my_function <- function(col){
  new_col <- col + 2.5 / 50 
  return(col)
}
```
]

Function has:
+ A name (`my_function`)
+ An input (`cols`, can be applied to any column/vector in this case)
+ A return value (by default, returns the last line, but can be explicit with `return()`)